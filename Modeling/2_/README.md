# Modeling Interview Question

## [Gradient Descent](http://cs229.stanford.edu/notes/cs229-notes1.pdf)

With your choice of software tool, implement the **batch gradient descent algorithm**
to uncover the linear relationship between speed and break distance:

` break distance = b0 + b1 * speed`

Find the optimal b0 and b1.

Note:
- You can use linear algebra or matrix operation libraries.
- Set the initial guess of beta at 1.


Gradient Descent API:
```java
GradientDescent Class
=====================================
get_beta()                                  // receive the betas
get_mse()                                   // receive the mean squared error
summary()                                   // print out the gradient search iteration summary
run(max_iter = 2000, alpha = 1e-4)          // run gradient descent iterations and returns the betas and mse

__gradient_step(alpha, step)                // internal function to make a gradient step
```

Use the following data set to model the relationship between *break distance* and *speed*:
```python
# speed vs. break distance data set

speed = [4,	4,	7,	7,	8,	9,	10,	10,	10,	11,	11,	12,	12,	12,	12,	13,	13,	13,	13,	14,	14,	14,	14,
15,	15,	15,	16,	16,	17,	17,	17,	18,	18, 18,	18,	19,	19,	19,	20, 20,	20,	20,	20,	22,	23,	24,	24,	24,	24,	25]

break_distance = [2, 10, 4,	22,	16,	10,	18,	26,	34,	17,	28,	14,	20,	24,	28,	26,	34,	34,	46,	26,	36,	60,	80,
20,	26,	54,	32,	40,	32,	40, 50,	42,	56,	76,	84, 36,	46,	68,	32,	48, 52,	56,	64,	66,	54,	70, 92,	93,	120, 85]
```

## Answer:

My choice of software is Python 2.7 and I use the numpy package.

```python
import numpy as np


class GradientDescent:
    """
    **********************************
     Batch Gradient Descent Algorithm
    **********************************

    Author: Joon Lim <powerlim2@gmail.com>

    """
    def __init__(self, x, y):
        assert len(x) == len(y)

        self.x = np.array([np.ones(len(x)), x]).transpose()
        self.y = np.array(y)
        self.__mse = None
        self.__beta = np.ones(self.x.shape[1])  # initial guess of beta set to 1
        self.__summary = "Gradient Search Iteration Summary\n\n"

    def summary(self):
        print self.__summary

    def run(self, max_iter = 2000, alpha = 1e-4):
        """
        if MSE converges during the iteration, finish the iteration and return the beta and MSE.
        """
        converge = False
        previous_mse = 99999
        step = 0
        while (not converge and step < max_iter):
            mse = self.__gradient_step(alpha, step)
            if abs(previous_mse - mse) * 2 < 1e-3:
                converge = True
            previous_mse = mse
            step += 1

        return self.__beta, self.__mse * 2

    def __gradient_step(self, alpha, step):
        """
        batch gradient descent iteration step
        """
        y_hat = self.x.dot(self.__beta)
        error = y_hat - self.y
        self.__mse = 1. / (2 * len(y_hat)) * np.sum(error ** 2)
        gradient = 1. / len(y_hat) * self.x.transpose().dot(error)
        self.__beta -= alpha * gradient
        self.__summary += "Iter: {}, mse: {}, beta: {}\n".format(step, self.__mse * 2, self.__beta)

        return self.__mse

    def get_beta(self):
        if self.__mse is not None:
            return self.__beta
        return

    def get_mse(self):
        if self.__mse is not None:
            return self.__mse * 2
        return


def main():
    speed = [4,	4,	7,	7,	8,	9,	10,	10,	10,	11,	11,	12,	12,	12,	12,	13,	13,	13,	13,	14,	14,	14,	14,
    15,	15,	15,	16,	16,	17,	17,	17,	18,	18, 18,	18,	19,	19,	19,	20, 20,	20,	20,	20,	22,	23,	24,	24,	24,	24,	25]
    break_distance = [2, 10, 4,	22,	16,	10,	18,	26,	34,	17,	28,	14,	20,	24,	28,	26,	34,	34,	46,	26,	36,	60,	80,
    20,	26,	54,	32,	40,	32,	40, 50,	42,	56,	76,	84, 36,	46,	68,	32,	48, 52,	56,	64,	66,	54,	70, 92,	93,	120, 85]

    SLR = GradientDescent(speed, break_distance)
    beta, mse = SLR.run(max_iter = 2000, alpha = 1e-4)

    SLR.summary()
    print "\n"
    print "break_distance = {} + {} * speed".format(beta[0], beta[1])


if __name__ == "__main__":
    main()
```

output:
```
Gradient Search Iteration Summary

Iter: 0, mse: 1169.18, beta: [ 1.002658  1.048968]
Iter: 1, mse: 1121.71979531, beta: [ 1.00524032  1.09663641]
Iter: 2, mse: 1076.74583424, beta: [ 1.00774898  1.14303973]
Iter: 3, mse: 1034.12787073, beta: [ 1.01018592  1.18821153]
Iter: 4, mse: 993.742481882, beta: [ 1.01255306  1.23218452]
Iter: 5, mse: 955.47271052, beta: [ 1.01485224  1.27499052]
Iter: 6, mse: 919.20772646, beta: [ 1.01708527  1.3166605 ]
Iter: 7, mse: 884.842505544, beta: [ 1.0192539   1.35722461]
Iter: 8, mse: 852.277525483, beta: [ 1.02135985  1.39671223]
Iter: 9, mse: 821.418477631, beta: [ 1.02340478  1.43515192]
Iter: 10, mse: 792.175993858, beta: [ 1.0253903   1.47257149]
Iter: 11, mse: 764.465387734, beta: [ 1.02731801  1.50899804]
Iter: 12, mse: 738.20640927, beta: [ 1.02918942  1.54445792]
Iter: 13, mse: 713.32301251, beta: [ 1.03100603  1.57897679]
Iter: 14, mse: 689.743135291, beta: [ 1.03276931  1.61257963]
Iter: 15, mse: 667.398490548, beta: [ 1.03448066  1.64529076]
Iter: 16, mse: 646.224368549, beta: [ 1.03614146  1.67713385]
Iter: 17, mse: 626.159449491, beta: [ 1.03775306  1.70813194]
Iter: 18, mse: 607.145625912, beta: [ 1.03931676  1.73830746]
Iter: 19, mse: 589.127834407, beta: [ 1.04083384  1.76768225]
Iter: 20, mse: 572.053896159, beta: [ 1.04230552  1.79627756]
Iter: 21, mse: 555.874365827, beta: [ 1.04373303  1.82411409]
Iter: 22, mse: 540.542388349, beta: [ 1.04511752  1.85121198]
Iter: 23, mse: 526.013563242, beta: [ 1.04646014  1.87759084]
Iter: 24, mse: 512.245816017, beta: [ 1.047762    1.90326974]
Iter: 25, mse: 499.19927633, beta: [ 1.04902419  1.92826729]
Iter: 26, mse: 486.836162511, beta: [ 1.05024776  1.95260155]
Iter: 27, mse: 475.120672146, beta: [ 1.05143373  1.97629014]
Iter: 28, mse: 464.018878391, beta: [ 1.0525831  1.9993502]
Iter: 29, mse: 453.498631716, beta: [ 1.05369684  2.02179841]
Iter: 30, mse: 443.529466801, beta: [ 1.0547759   2.04365102]
Iter: 31, mse: 434.082514299, beta: [ 1.0558212   2.06492384]
Iter: 32, mse: 425.130417236, beta: [ 1.05683363  2.08563225]
Iter: 33, mse: 416.647251778, beta: [ 1.05781408  2.10579124]
Iter: 34, mse: 408.608452152, beta: [ 1.05876338  2.12541539]
Iter: 35, mse: 400.990739509, beta: [ 1.05968236  2.1445189 ]
Iter: 36, mse: 393.772054499, beta: [ 1.06057183  2.1631156 ]
Iter: 37, mse: 386.931493388, beta: [ 1.06143258  2.18121893]
Iter: 38, mse: 380.44924752, beta: [ 1.06226536  2.198842  ]
Iter: 39, mse: 374.306545948, beta: [ 1.06307092  2.21599755]
Iter: 40, mse: 368.485601075, beta: [ 1.06384997  2.23269799]
Iter: 41, mse: 362.969557134, beta: [ 1.06460323  2.2489554 ]
Iter: 42, mse: 357.742441378, beta: [ 1.06533138  2.26478155]
Iter: 43, mse: 352.789117818, beta: [ 1.06603508  2.28018788]
Iter: 44, mse: 348.09524339, beta: [ 1.06671499  2.29518553]
Iter: 45, mse: 343.647226415, beta: [ 1.06737173  2.30978536]
Iter: 46, mse: 339.432187237, beta: [ 1.06800593  2.32399793]
Iter: 47, mse: 335.437920924, beta: [ 1.06861817  2.33783351]
Iter: 48, mse: 331.652861918, beta: [ 1.06920904  2.35130211]
Iter: 49, mse: 328.066050543, beta: [ 1.06977912  2.36441348]
Iter: 50, mse: 324.667101263, beta: [ 1.07032894  2.3771771 ]
Iter: 51, mse: 321.446172608, beta: [ 1.07085906  2.3896022 ]
Iter: 52, mse: 318.393938668, beta: [ 1.07136998  2.40169776]
Iter: 53, mse: 315.501562087, beta: [ 1.07186223  2.41347253]
Iter: 54, mse: 312.76066847, beta: [ 1.0723363   2.42493504]
Iter: 55, mse: 310.163322127, beta: [ 1.07279267  2.43609356]
Iter: 56, mse: 307.702003093, beta: [ 1.0732318   2.44695616]
Iter: 57, mse: 305.369585349, beta: [ 1.07365417  2.45753072]
Iter: 58, mse: 303.159316186, beta: [ 1.0740602   2.46782486]
Iter: 59, mse: 301.064796645, beta: [ 1.07445035  2.47784603]
Iter: 60, mse: 299.079962988, beta: [ 1.07482502  2.48760148]
Iter: 61, mse: 297.199069136, beta: [ 1.07518463  2.49709826]
Iter: 62, mse: 295.416670028, beta: [ 1.07552958  2.50634325]
Iter: 63, mse: 293.727605853, beta: [ 1.07586026  2.51534312]
Iter: 64, mse: 292.126987103, beta: [ 1.07617704  2.52410437]
Iter: 65, mse: 290.610180417, beta: [ 1.07648031  2.53263336]
Iter: 66, mse: 289.17279516, beta: [ 1.0767704   2.54093623]
Iter: 67, mse: 287.810670706, beta: [ 1.07704768  2.54901899]
Iter: 68, mse: 286.519864394, beta: [ 1.07731249  2.55688749]
Iter: 69, mse: 285.296640102, beta: [ 1.07756515  2.56454742]
Iter: 70, mse: 284.137457435, beta: [ 1.07780599  2.5720043 ]
Iter: 71, mse: 283.038961463, beta: [ 1.07803533  2.57926353]
Iter: 72, mse: 281.997973015, beta: [ 1.07825346  2.58633036]
Iter: 73, mse: 281.011479461, beta: [ 1.07846068  2.5932099 ]
Iter: 74, mse: 280.076625995, beta: [ 1.07865729  2.59990711]
Iter: 75, mse: 279.190707367, beta: [ 1.07884357  2.60642683]
Iter: 76, mse: 278.351160042, beta: [ 1.07901979  2.61277378]
Iter: 77, mse: 277.555554783, beta: [ 1.07918621  2.61895255]
Iter: 78, mse: 276.801589612, beta: [ 1.07934311  2.62496759]
Iter: 79, mse: 276.087083142, beta: [ 1.07949072  2.63082326]
Iter: 80, mse: 275.409968265, beta: [ 1.07962931  2.63652379]
Iter: 81, mse: 274.76828616, beta: [ 1.0797591   2.64207328]
Iter: 82, mse: 274.160180622, beta: [ 1.07988033  2.64747576]
Iter: 83, mse: 273.583892687, beta: [ 1.07999323  2.65273513]
Iter: 84, mse: 273.037755537, beta: [ 1.08009802  2.65785518]
Iter: 85, mse: 272.520189673, beta: [ 1.08019491  2.66283961]
Iter: 86, mse: 272.029698342, beta: [ 1.08028412  2.66769203]
Iter: 87, mse: 271.564863198, beta: [ 1.08036584  2.67241593]
Iter: 88, mse: 271.124340201, beta: [ 1.08044029  2.67701473]
Iter: 89, mse: 270.706855718, beta: [ 1.08050764  2.68149175]
Iter: 90, mse: 270.311202839, beta: [ 1.08056809  2.68585022]
Iter: 91, mse: 269.936237879, beta: [ 1.08062183  2.69009329]
Iter: 92, mse: 269.580877067, beta: [ 1.08066902  2.69422403]
Iter: 93, mse: 269.244093409, beta: [ 1.08070985  2.69824541]
Iter: 94, mse: 268.924913709, beta: [ 1.08074448  2.70216033]
Iter: 95, mse: 268.622415755, beta: [ 1.08077308  2.70597163]
Iter: 96, mse: 268.335725647, beta: [ 1.0807958   2.70968206]
Iter: 97, mse: 268.064015265, beta: [ 1.08081281  2.71329428]
Iter: 98, mse: 267.806499872, beta: [ 1.08082426  2.71681092]
Iter: 99, mse: 267.562435839, beta: [ 1.08083029  2.7202345 ]
Iter: 100, mse: 267.331118496, beta: [ 1.08083104  2.7235675 ]
Iter: 101, mse: 267.111880087, beta: [ 1.08082667  2.72681232]
Iter: 102, mse: 266.904087837, beta: [ 1.08081729  2.7299713 ]
Iter: 103, mse: 266.70714212, beta: [ 1.08080306  2.73304672]
Iter: 104, mse: 266.520474724, beta: [ 1.08078408  2.7360408 ]
Iter: 105, mse: 266.343547203, beta: [ 1.0807605   2.73895569]
Iter: 106, mse: 266.175849316, beta: [ 1.08073243  2.74179351]
Iter: 107, mse: 266.016897556, beta: [ 1.0807      2.74455629]
Iter: 108, mse: 265.866233742, beta: [ 1.08066331  2.74724603]
Iter: 109, mse: 265.723423697, beta: [ 1.08062249  2.74986467]
Iter: 110, mse: 265.588055989, beta: [ 1.08057763  2.75241409]
Iter: 111, mse: 265.45974074, beta: [ 1.08052886  2.75489614]
Iter: 112, mse: 265.338108495, beta: [ 1.08047627  2.75731259]
Iter: 113, mse: 265.222809155, beta: [ 1.08041996  2.75966519]
Iter: 114, mse: 265.113510961, beta: [ 1.08036003  2.76195564]
Iter: 115, mse: 265.009899533, beta: [ 1.08029658  2.76418559]
Iter: 116, mse: 264.911676962, beta: [ 1.08022971  2.76635664]
Iter: 117, mse: 264.818560943, beta: [ 1.08015949  2.76847036]
Iter: 118, mse: 264.730283963, beta: [ 1.08008603  2.77052826]
Iter: 119, mse: 264.64659252, beta: [ 1.08000941  2.77253183]
Iter: 120, mse: 264.567246395, beta: [ 1.07992971  2.77448251]
Iter: 121, mse: 264.492017952, beta: [ 1.07984702  2.77638171]
Iter: 122, mse: 264.42069148, beta: [ 1.0797614   2.77823079]
Iter: 123, mse: 264.353062568, beta: [ 1.07967295  2.78003109]
Iter: 124, mse: 264.288937514, beta: [ 1.07958174  2.78178389]
Iter: 125, mse: 264.228132763, beta: [ 1.07948783  2.78349046]
Iter: 126, mse: 264.170474377, beta: [ 1.07939131  2.78515202]
Iter: 127, mse: 264.115797529, beta: [ 1.07929223  2.78676978]
Iter: 128, mse: 264.063946027, beta: [ 1.07919068  2.78834489]
Iter: 129, mse: 264.01477186, beta: [ 1.07908671  2.78987848]
Iter: 130, mse: 263.968134774, beta: [ 1.07898039  2.79137166]
Iter: 131, mse: 263.923901859, beta: [ 1.07887178  2.7928255 ]
Iter: 132, mse: 263.88194717, beta: [ 1.07876094  2.79424105]
Iter: 133, mse: 263.842151359, beta: [ 1.07864793  2.79561932]
Iter: 134, mse: 263.804401331, beta: [ 1.07853281  2.79696129]
Iter: 135, mse: 263.768589914, beta: [ 1.07841564  2.79826795]
Iter: 136, mse: 263.734615551, beta: [ 1.07829647  2.79954021]
Iter: 137, mse: 263.702382007, beta: [ 1.07817534  2.800779  ]
Iter: 138, mse: 263.671798087, beta: [ 1.07805233  2.8019852 ]
Iter: 139, mse: 263.642777372, beta: [ 1.07792746  2.80315968]
Iter: 140, mse: 263.615237973, beta: [ 1.07780081  2.80430328]
Iter: 141, mse: 263.589102289, beta: [ 1.0776724   2.80541682]
Iter: 142, mse: 263.564296786, beta: [ 1.07754229  2.80650109]
Iter: 143, mse: 263.540751779, beta: [ 1.07741052  2.80755688]
Iter: 144, mse: 263.518401237, beta: [ 1.07727714  2.80858495]
Iter: 145, mse: 263.497182587, beta: [ 1.0771422   2.80958602]
Iter: 146, mse: 263.477036532, beta: [ 1.07700572  2.81056081]
Iter: 147, mse: 263.457906885, beta: [ 1.07686776  2.81151003]
Iter: 148, mse: 263.4397404, beta: [ 1.07672834  2.81243434]
Iter: 149, mse: 263.42248662, beta: [ 1.07658752  2.81333441]
Iter: 150, mse: 263.406097734, beta: [ 1.07644533  2.81421089]
Iter: 151, mse: 263.390528432, beta: [ 1.0763018   2.81506441]
Iter: 152, mse: 263.375735781, beta: [ 1.07615697  2.81589556]
Iter: 153, mse: 263.361679095, beta: [ 1.07601087  2.81670494]
Iter: 154, mse: 263.348319819, beta: [ 1.07586355  2.81749314]
Iter: 155, mse: 263.335621421, beta: [ 1.07571502  2.81826071]
Iter: 156, mse: 263.323549279, beta: [ 1.07556533  2.8190082 ]
Iter: 157, mse: 263.312070587, beta: [ 1.0754145   2.81973615]
Iter: 158, mse: 263.301154257, beta: [ 1.07526256  2.82044508]
Iter: 159, mse: 263.290770828, beta: [ 1.07510955  2.82113548]
Iter: 160, mse: 263.280892386, beta: [ 1.07495549  2.82180785]
Iter: 161, mse: 263.271492477, beta: [ 1.07480041  2.82246267]
Iter: 162, mse: 263.262546031, beta: [ 1.07464434  2.8231004 ]
Iter: 163, mse: 263.254029296, beta: [ 1.0744873   2.82372151]
Iter: 164, mse: 263.24591976, beta: [ 1.07432932  2.82432642]
Iter: 165, mse: 263.238196092, beta: [ 1.07417043  2.82491557]
Iter: 166, mse: 263.230838079, beta: [ 1.07401064  2.82548938]
Iter: 167, mse: 263.223826567, beta: [ 1.07384998  2.82604826]
Iter: 168, mse: 263.217143403, beta: [ 1.07368849  2.8265926 ]
Iter: 169, mse: 263.210771388, beta: [ 1.07352616  2.82712278]
Iter: 170, mse: 263.204694223, beta: [ 1.07336304  2.82763919]
Iter: 171, mse: 263.198896462, beta: [ 1.07319914  2.82814219]
Iter: 172, mse: 263.193363468, beta: [ 1.07303448  2.82863214]
Iter: 173, mse: 263.188081373, beta: [ 1.07286909  2.82910937]
Iter: 174, mse: 263.183037034, beta: [ 1.07270297  2.82957423]
Iter: 175, mse: 263.178217995, beta: [ 1.07253616  2.83002706]
Iter: 176, mse: 263.173612456, beta: [ 1.07236866  2.83046815]
Iter: 177, mse: 263.169209231, beta: [ 1.0722005   2.83089784]
Iter: 178, mse: 263.164997725, beta: [ 1.0720317   2.83131642]
Iter: 179, mse: 263.160967893, beta: [ 1.07186227  2.83172418]
Iter: 180, mse: 263.157110219, beta: [ 1.07169223  2.83212142]
Iter: 181, mse: 263.153415686, beta: [ 1.07152159  2.83250841]
Iter: 182, mse: 263.149875748, beta: [ 1.07135038  2.83288542]
Iter: 183, mse: 263.146482306, beta: [ 1.0711786   2.83325273]
Iter: 184, mse: 263.143227688, beta: [ 1.07100627  2.83361058]
Iter: 185, mse: 263.140104621, beta: [ 1.07083341  2.83395923]
Iter: 186, mse: 263.137106215, beta: [ 1.07066003  2.83429892]
Iter: 187, mse: 263.134225939, beta: [ 1.07048614  2.83462989]
Iter: 188, mse: 263.131457608, beta: [ 1.07031176  2.83495237]
Iter: 189, mse: 263.128795355, beta: [ 1.07013691  2.83526659]
Iter: 190, mse: 263.126233627, beta: [ 1.06996158  2.83557277]
Iter: 191, mse: 263.123767156, beta: [ 1.0697858   2.83587112]
Iter: 192, mse: 263.121390954, beta: [ 1.06960958  2.83616184]
Iter: 193, mse: 263.119100293, beta: [ 1.06943293  2.83644514]
Iter: 194, mse: 263.116890692, beta: [ 1.06925587  2.83672122]
Iter: 195, mse: 263.114757905, beta: [ 1.06907839  2.83699027]
Iter: 196, mse: 263.11269791, beta: [ 1.06890052  2.83725248]
Iter: 197, mse: 263.110706893, beta: [ 1.06872226  2.83750802]
Iter: 198, mse: 263.108781243, beta: [ 1.06854362  2.83775707]
Iter: 199, mse: 263.106917535, beta: [ 1.06836462  2.83799982]
Iter: 200, mse: 263.105112525, beta: [ 1.06818527  2.83823641]
Iter: 201, mse: 263.10336314, beta: [ 1.06800556  2.83846702]
Iter: 202, mse: 263.101666465, beta: [ 1.06782552  2.83869181]
Iter: 203, mse: 263.100019741, beta: [ 1.06764516  2.83891093]
Iter: 204, mse: 263.098420352, beta: [ 1.06746447  2.83912453]
Iter: 205, mse: 263.096865818, beta: [ 1.06728347  2.83933275]
Iter: 206, mse: 263.095353791, beta: [ 1.06710217  2.83953575]
Iter: 207, mse: 263.093882044, beta: [ 1.06692057  2.83973366]
Iter: 208, mse: 263.092448468, beta: [ 1.06673869  2.8399266 ]
Iter: 209, mse: 263.091051065, beta: [ 1.06655653  2.84011473]
Iter: 210, mse: 263.089687941, beta: [ 1.0663741   2.84029816]
Iter: 211, mse: 263.088357299, beta: [ 1.0661914   2.84047701]
Iter: 212, mse: 263.08705744, beta: [ 1.06600845  2.84065142]
Iter: 213, mse: 263.085786751, beta: [ 1.06582524  2.84082149]
Iter: 214, mse: 263.084543706, beta: [ 1.0656418   2.84098735]
Iter: 215, mse: 263.083326857, beta: [ 1.06545811  2.8411491 ]
Iter: 216, mse: 263.082134832, beta: [ 1.0652742   2.84130685]
Iter: 217, mse: 263.080966332, beta: [ 1.06509006  2.84146071]
Iter: 218, mse: 263.079820125, beta: [ 1.0649057   2.84161079]
Iter: 219, mse: 263.078695045, beta: [ 1.06472113  2.84175718]
Iter: 220, mse: 263.077589984, beta: [ 1.06453635  2.84189998]
Iter: 221, mse: 263.076503896, beta: [ 1.06435137  2.84203929]
Iter: 222, mse: 263.075435787, beta: [ 1.06416619  2.8421752 ]
Iter: 223, mse: 263.074384715, beta: [ 1.06398083  2.8423078 ]
Iter: 224, mse: 263.073349791, beta: [ 1.06379528  2.84243717]
Iter: 225, mse: 263.072330167, beta: [ 1.06360954  2.84256341]
Iter: 226, mse: 263.071325044, beta: [ 1.06342363  2.84268659]
Iter: 227, mse: 263.070333663, beta: [ 1.06323755  2.8428068 ]



break_distance = 1.06323755428 + 2.84280680209 * speed
```